# -*- coding: utf-8 -*-
"""dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JkRwPsoLT6_OabUYm2JUTYTO2ZNxf_AU
"""

from torch.utils.data import Dataset
import torchvision.transforms as transforms
import cv2

class YOLODataset(Dataset):
    def __init__(self, data_path):
        self.data_path = data_path
        self.samples = open(data_path).read().splitlines()
        self.transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Resize((416, 416))
        ])

    def __len__(self):
        return len(self.samples)

    def __getitem__(self, idx):
        img_path = self.samples[idx]
        img = cv2.imread(img_path)
        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)
        img = self.transform(img)
        return img, torch.zeros((1, 5))  # Dummy target